{% comment %}
This is a function to turn YML sidebar definitions into HTML lists.
Based on tip in http://hamishwillee.github.io/2014/11/13/jekyll-includes-are-functions/
{% endcomment %}

{% if include.item.contents %}
    {% assign currentLevel = include.level | plus: 0 %}
    {% assign nextLevel = include.level | plus: 1 %}
    {% if currentLevel < 10 %}
    <li>
        <a href="#">{{ include.item.title }}</a>
        <ul>
            {% for subitem in include.item.contents %}
            {% include /functions/recursive_item_to_list.html item=subitem level=nextLevel %}
            {% endfor %}
        </ul>
    </li>
    {% endif %} {% comment %}if currentLevel < 10 {% endcomment %}
{% else %}
    {% if include.item.url contains "http://" or include.item.url contains ".pdf"%}
    {% assign targetAttribute = 'target="_blank"' %}
    {% else %}
    {% assign targetAttribute = '' %}
    {% endif %}

    {% if include.item.url contains "http://"%}
    {% assign url = include.item.url %}
    {% else %}
    {% assign url = include.item.url | prepend: site.baseurl %}
    {% endif %}


    {% if page.url == include.item.url %}
    <li class="active"><a href="{{url}}">{{include.item.title}}</a></li>
    {% else %}
    <li><a href="{{url}}" {{targetAttribute}}>{{include.item.title}}</a></li>
    {% endif %}
{% endif %}

